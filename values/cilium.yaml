# Kubernetes API Server configuration
k8sServiceHost: "172.16.101.101"
k8sServicePort: "6443"

# Enable kube-proxy replacement
kubeProxyReplacement: "true"
kubeProxyReplacementHealthzBindAddr: "0.0.0.0:10256"

# MTU configuration
mtu: 1500

# Devices for L2 announcements
devices: "eth+"

# Routing configuration
# Native routing for better performance on same L2 network
routingMode: "native"
autoDirectNodeRoutes: true
ipv4NativeRoutingCIDR: "10.42.0.0/16"

# IPAM configuration for Pod networking
ipam:
  mode: "kubernetes"

# L2 Announcements for LoadBalancer services
l2announcements:
  enabled: true
  leaseDuration: 15s
  leaseRenewDeadline: 5s
  leaseRetryPeriod: 2s

# Load Balancer configuration
loadBalancer:
  algorithm: random

# Socket-level load balancing - bypasses iptables for lower latency
socketLB:
  enabled: true

# Bandwidth Manager with BBR for improved throughput and latency
bandwidthManager:
  enabled: true
  bbr: true

# BPF optimizations
bpf:
  masquerade: true
  hostLegacyRouting: false
  # Netkit device mode for lower pod networking overhead (requires kernel 6.8+)
  datapathMode: netkit
  # Distributed LRU for reduced spinlock contention under high connection load
  distributedLRU:
    enabled: true
  # Dynamic map sizing (8% of node memory for CT/NAT maps)
  mapDynamicSizeRatio: 0.08

# Enable L2 neighbor discovery
l2NeighDiscovery:
  enabled: true

# Operator configuration
operator:
  replicas: 1

# Envoy proxy - disable external DaemonSet, use embedded in Cilium agent
envoy:
  enabled: false

# Hubble network observability
hubble:
  enabled: true
  peerService:
    clusterDomain: k8s.home.lex.la
  relay:
    enabled: true
    service:
      type: LoadBalancer
    resources:
      requests:
        cpu: 50m
        memory: 64Mi
      limits:
        cpu: 200m
        memory: 256Mi
  ui:
    enabled: true
    backend:
      resources:
        requests:
          cpu: 25m
          memory: 32Mi
        limits:
          cpu: 100m
          memory: 128Mi
    frontend:
      resources:
        requests:
          cpu: 25m
          memory: 32Mi
        limits:
          cpu: 100m
          memory: 128Mi

# Gateway API support
gatewayAPI:
  enabled: true
  enableAlpn: true

# Tolerations for Cilium agent DaemonSet
tolerations:
  - operator: Exists
