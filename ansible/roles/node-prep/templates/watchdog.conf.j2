# {{ ansible_managed }}
# Watchdog configuration with gateway ping monitoring
#
# This configuration enables hardware watchdog with gateway reachability check.
# If the gateway (172.16.0.1) is unreachable for more than retry-timeout seconds,
# watchdog will reboot the system to recover network connectivity.
# See Error 15 in CLAUDE.md for context (network death without link down).

watchdog-device = {{ node_prep_watchdog_device }}
watchdog-timeout = {{ node_prep_watchdog_timeout }}
interval = {{ node_prep_watchdog_interval }}
realtime = {{ node_prep_watchdog_realtime }}
priority = {{ node_prep_watchdog_priority }}

# Gateway ping monitoring
# More reliable than interface monitoring - catches cases where link is UP but no traffic
ping = {{ node_prep_watchdog_ping_target }}

# Reboot if gateway unreachable for this many seconds
retry-timeout = {{ node_prep_watchdog_retry_timeout }}
